#summary Repulse reference manual and documentation
#labels Repulse,Documentation,README
#sidebar TableOfContents

<wiki:toc max_depth="3" />

=Introduction=

==What is repulse?==
Repulse is a MIDI Jack real time sampler machine that can be used to play drum kits or other sounds. It has 8 voices of polyphony and supports a rich set of parameters per voice.<br>
Repulse does not contain a sequencer, use any sequencer of your choice to control the sampler, try [http://www.filter24.org/seq24 Seq42] or [http://www.rosegardenmusic.com Rosegarden].

==Voice controllers==
This are some of the parameters per voice:
 * _Start time:_ delays the start time of the sound the given miliseconds.
 * _Transpose:_ transpose the sound the given octaves.
 * _Time Stretch:_ stretch the sound by the given percentage (the pitch does not change), you have different time stretch types to choose from.
 * _Staturation:_ introduce analog like saturation into the sound.
 * _Filtering:_ you have five types to choose from with controllable cutoff and resonance:
  * Low pass.
  * High pass.
  * Band pass 1.
  * Band pass 2.
  * Notch
 * _Envelope:_ you have three envelopes to choose from, with a tuneable decay time:
    * Infinite: does not apply any envelope.
    * Trigger: also known as one shot, starts the decay envelope on note on event.
    * Gate: starts the decay after the note off event.
 * _Panning:_ pan the voice to the left or the right in the stereo output.
 * _Volume:_ adjusts the output volume of the voice.

==Controller modulation==
Almost any parameter can be modulated jointly by note velocity and a random source.
 * Modulating by *note velocity* you can create a velocity reactive sampler, other parameters can be modulated by velocity to achieve subtle effects.
 * Modulating different parameters by the *random source*, with small values, induces an analogue feeling to the machine.

You can apply random modulation to all the parameters at the same time by a minuscule value to achieve an analogue effect. Or you can turn the random modulations up to get strange effects.<br>
The velocity modulation can applied to uncommon parameters at the same time, like the cutoff frequency, to get interesting sounds.

==MIDI support==
You can drive any parameter that you can see in the GUI with a midi controller. You can check the [Controllers] page to see the detailed controller mappings.<br>
The MIDI support is quite good with repulse responding to the program change, all controllers/notes off, omni, poly, volume and plenty of other custom events.<br>
Currently the supported MIDI driver is ALSA, Jack will be added in the future.

=Installing=
==Dependencies==
 * ALSA [http://www.alsa-project.org]
 * Jack [http://jackaudio.org]
 * !SndFile [http://www.mega-nerd.com/libsndfile]
 * Secret Rabbit (libsamplerate) [http://www.mega-nerd.com/SRC]

==Compiling from SVN==

Use this command to anonymously check out the latest project source code:
{{{
svn checkout http://repulse.googlecode.com/svn/trunk/ repulse
}}}

After downloading you can compile a binary like this:
{{{
cd repulse
./build.sh
}}}

==Executing==

You can go on and execute repulse like this:
{{{
./repulse -c patch.xml
}}}

In general you can execute:
{{{
repulse [-c] [-n jack_client_name] <patch_file>
}}}

This are the repulse command line switches:
 * _-c_: autoconnect the repulse stereo output to the first physical output.
 * _-n jack_client_name_: the client name in the Jack environment.

By default the engine name is repulse and the machine does not autoconnect its outputs.<br>
So if you dont use the -c switch you have to manually connect the outputs.<br>
Repulse searches for wave files relative to the binary location folder.

=Curses GUI=
[http://img219.imageshack.us/img219/8738/screenv001.png]

==Keyboard controls==
 * _Arrow keys:_ moves the cursor in the spread-sheet like grid.
 * _A key:_ tune the selected cell parmeter up.
 * _Z key:_ tune the selected cell parmeter down.
 * _S key:_ tune the selected cell parmeter up, finer increment.
 * _X key:_ tune the selected cell parmeter down, finer decrement.
 * _+ key:_ increment the selected preset number.
 * _- key:_ decrement the selected preset number.
 * _CONTROL + N:_ create a new preset.
 * _CONTROL + B:_ save the current preset.
 * _CONTROL + R:_ recall the currently selected preset.
 * _CONTROL + L:_ local on/off toggle.
   * When active the machine will interpret its control surface events and MIDI events.
   * When deactivated the machine will interpret only MIDI events.
 * _CONTROL + W:_ alternate wheel toggle.
   * when activated the pitch bend wheel controls the engine's time stretch value.
   * When deactivated the pitch bend wheel controls the engine's transpose value.
 * _CONTROL + O:_ omni on/off toggle.
   * When activated the machine will receive MIDI events in any channel.
   * When deactivated the machine will receive MIDI events only the base channel (10).
 * _CONTROL + V:_ Mono on/off toggle.
   * When activated the machine operates in mono and does not mix-down the stereo channel.
   * When deactivated the machine operates in mono and does the mix-down of the stereo channel.
 * _CONTROL + E:_ quits the software.
 * _CONTROL + T:_ changes the MIDI base note, by default it is 60 (middle c).
 * _CONTROL + J:_ changes the MIDI base channel, by default it is the channel 10.

==Engine DSP controllers==
 * _Transpose:_ apply a pitch transposition by the given octaves to all voices.
 * _Stretch:_ time-stretch (does not change pitch) all voices by the given percentage.
 * _Volume:_ decrease or increase the voice gain.

==Voice DSP controllers==
 * _Start:_ advance the sample start point by the given miliseconds.
 * _Soft Start:_ apply a quick attack envelope to the sound start.
 * _Transpose:_ apply a pitch transposition by the given octaves.
 * _Transpose Velocity:_ affect the transpose value by the note's velocity (by this percentage).
 * _Transpose Random:_ affect the transpose value by a random source (by this percentage).
 * _Stretch:_ time-stretch (does not change pitch) the voice by the given percentage.
 * _Stretch Velocity:_ affect the stretch value by the note's velocity (by this percentage).
 * _Stretch Type:_ choose from a set of time-stretch types to suit your sound's needs.
  * _Auto:_ should suit any sound type automatically.
  * _Speech:_ this type is well suited for speech sounds.
  * _Type 1:_ alternative mode to choose from.
  * _Type 2:_ alternative mode to choose from.
 * _Over Drive:_ overdrives the sound by the given amount, you have to activate the Saturation toggle.
 * _Saturate:_ activates the saturation of the sound by the given Over Drive amount.
 * _Filter Frequency:_ middle point frequency for the different filters.
 * _Filter:_ activate or deactivate the filter.
 * _Filter Type_: there are five types of filter to choose from.
  * _Low Pass_ filter.
  * _High Pass_ filter.
  * _Band Pass 1_ filter.
  * _Band Pass 2_ filter (an alternative implementation).
  * _Notch_ filter.
 * _Filter Resonance:_ controls the filter resonance value.
 * _Filter Velocity:_ affect the filter frequency value by the note's velocity (by this percentage).
 * _Filter Random:_ affect the filter frequency value by a random source (by this percentage).
 * _Decay:_ sets the envelope decay time in seconds
 * _Decay Envelope:_ there are three envelope types to choose from.
  * _Infinite:_ no envelope applied when this type is selected, the voice 'just' plays.
  * _Trigger:_ the decay envelope starts after a note on event.
  * _Gate:_ the decay envelope starts after a note off event.
 * _Panning:_ displaces the voice to the left or right of the stereo mix.
 * _Panning Velocity:_ affect the panning value by the note's velocity (by this percentage).
 * _Panning Random:_ affect the panning value by a random source (by this percentage).
 * _Volume:_ decrease or increase the voice gain.
 * _Volume Velocity:_ affect the volume value by the note's velocity (by this percentage).
 * _Mute:_ mute the selected voice.
 * _Solo:_ solo the selected voice.
 * _Join:_ stops the voice 7 when the voice 8 is started and viceversa.
.
=MIDI controllers=

==Engine controllers==
This are the controllers for the repulse engine, it listens to this controllers on the base channel 10 and 11<br>
Only the engine controllers are listened on any channel (omni).
 * You can send a _Program Change_ to select between the first 128 presets in the machine.
 * Sliding the _Pitch Wheel_ MIDI controller it is possible to apply a pitch transposition to all the voices.
 * You can switch the _Wheel_ toggle to make the _Pitch Wheel_ control the overall time-stretch.

|| *Name*              || *#* || *Description* ||
|| Program Change      || -   || Select a program between the 128 first contained in the machine. ||
|| Pitch Wheel         || -   || Apply a pitch transposition by the given octaves to all the voices. ||
|| Linked              || 2   || Stops the voice 7 when the voice 8 is started and viceversa (on/off). ||
|| Rranspose           || 4   || Apply a pitch transposition by the given octaves to all the voices (signed). ||
|| Stretch             || 5   || Apply time-stretch by the given percentage to all the voices (signed). ||
|| Volume              || 7   || Decrease or increase the voice gain. ||
|| All Sound Off       || 120 || Turns all the voices off (on/off). ||
|| All Controllers Off || 121 || Resets all the machine parameters to a default state (on/off). ||
|| Local Keyboard      || 122 || When activated the machine will interpret MIDI events and local surface events (on/off). ||
|| All Notes Off       || 123 || Turns all the voices off and sends a note off event to each voice (on/off). ||
|| Omni Mode Off       || 124 || Listen MIDI events only on channels 10 and 11 (on/off). ||
|| Omni Mode On        || 125 || Listen MIDI events on any channel (on/off). ||
|| Mono Operation      || 126 || Disable the stereo mix-down (on/off). ||
|| Poly Operation      || 127 || Enable the stereo mix-down (on/off). ||

==Voice controllers==
Almost every parameter in the machine can be controlled via MIDI.
<br>The number of controllers spans two midi channels, base channels 10 and 11.<br>
In MIDI channel 10 you have the common controllers, in MIDI channel 11 you can find the modulation controllers.<br>
The omni switch does not affect the voice controllers, you have to send them in their own channel.<br>
The engine related controllers can received in omni.<br>
This is the full list of voice (and engine) controllers.

 * The machine always receives voice controllers on channels 10 and 11. The MIDI base channel can be changed via the GUI.
 * The machine receives note on message for the MIDI notes 60 to 67. The MIDI base note can be changed via the GUI.

===Channel 10===
||  *Controller* || *Engine* || *Voice 01* || *Voice 02* || *Voice 03* || *Voice 04* || *Voice 05* || *Voice 06* || *Voice 07* || *Voice 08* ||
|| Engine Linked || 2 || - || - || - || - || - || - || - || - ||
|| Engine Transpose || 4 || - || - || - || - || - || - || - || - ||
|| Engine Stretch || 5 || - || - || - || - || - || - || - || - ||
|| Engine Volume || 7 || - || - || - || - || - || - || - || - ||
|| Sound Start || - || 8 || 22 || 36 || 50 || 64 || 78 || 92 || 106 ||
|| Sound Start Soft || - || 9 || 23 || 37 || 51 || 65 || 79 || 93 || 107 ||
|| Sound Transpose || - || 10 || 24 || 38 || 52 || 66 || 80 || 94 || 108 ||
|| Sound Stretch || - || 11 || 25 || 39 || 53 || 67 || 81 || 95 || 109 ||
|| Sound Over Drive || - || 12 || 26 || 40 || 54 || 68 || 82 || 96 || 110 ||
|| Sound Over Drive Active || - || 13 || 27 || 41 || 55 || 69 || 83 || 97 || 111 ||
|| Sound Filter Frequency || - || 14 || 28 || 42 || 56 || 70 || 84 || 98 || 112 ||
|| Sound Filter Active || - || 15 || 29 || 43 || 57 || 71 || 85 || 99 || 113 ||
|| Sound Filter Resonance || - || 16 || 30 || 44 || 58 || 72 || 86 || 100 || 114 ||
|| Sound Decay || - || 17 || 31 || 45 || 59 || 73 || 87 || 101 || 115 ||
|| Sound Panning || - || 18 || 32 || 46 || 60 || 74 || 88 || 102 || 116 ||
|| Sound Volume || - || 19 || 33 || 47 || 61 || 75 || 89 || 103 || 117 ||
|| Engine All Sound Off || 120 || - || - || - || - || - || - || - || - ||
|| Engine All Controllers Off || 121 || - || - || - || - || - || - || - || - ||
|| Engine Local Keyboard || 122 || - || - || - || - || - || - || - || - ||
|| Engine All Notes Off || 123 || - || - || - || - || - || - || - || - ||
|| Engine Omni Mode Off || 124 || - || - || - || - || - || - || - || - ||
|| Engine Omni Mode On || 125 || - || - || - || - || - || - || - || - ||
|| Engine Mono Operation || 126 || - || - || - || - || - || - || - || - ||
|| Engine Poly Operation || 127 || - || - || - || - || - || - || - || - ||

===Channel 11===
|| *Controller* || *Engine* || *Voice 01* || *Voice 02* || *Voice 03* || *Voice 04* || *Voice 05* || *Voice 06* || *Voice 07* || *Voice 08* ||
|| Sound Transpose Velocity || - || 8 || 22 || 36 || 50 || 64 || 78 || 92 || 106 ||
|| Sound Transpose Random || - || 9 || 23 || 37 || 51 || 65 || 79 || 93 || 107 ||
|| Sound Stretch Velocity || - || 10 || 24 || 38 || 52 || 66 || 80 || 94 || 108 ||
|| Sound Stretch Type || - || 11 || 25 || 39 || 53 || 67 || 81 || 95 || 109 ||
|| Sound Filter Type || - || 12 || 26 || 40 || 54 || 68 || 82 || 96 || 110 ||
|| Sound Filter Velocity || - || 13 || 27 || 41 || 55 || 69 || 83 || 97 || 111 ||
|| Sound Filter Random || - || 14 || 28 || 42 || 56 || 70 || 84 || 98 || 112 ||
|| Sound Decay Type || - || 15 || 29 || 43 || 57 || 71 || 85 || 99 || 113 ||
|| Sound Panning Velocity || - || 16 || 30 || 44 || 58 || 72 || 86 || 100 || 114 ||
|| Sound Panning Random || - || 17 || 31 || 45 || 59 || 73 || 87 || 101 || 115 ||
|| Sound Volume Velocity || - || 18 || 32 || 46 || 60 || 74 || 88 || 102 || 116 ||
|| Sound Muted || - || 19 || 33 || 47 || 61 || 75 || 89 || 103 || 117 ||
|| Sound Soloed || - || 20 || 34 || 48 || 62 || 76 || 90 || 104 || 118 ||

==Modulation grid==
This table shows the modulation capabilities, and which parameter is modulated by each of the two possible sources:

|| *Parameter* || *Note<br>Velocity* || *Random<br>Source* ||
|| Transpose   || x                  || x                  ||
|| Stretch     || x                  ||                    ||
|| Filter Frequency || x             || x                  ||
|| Panning     || x                  || x                  ||
|| Volume      || x                  ||                    ||

<br>

=Editing patches=
The patch editing (creating, renaming, deleting) capabilities are quite small.<br>
You can create a patch file by saving a text file with this content:

{{{
<Repulse>
    <Waves>
        <Wave file="909/BT7A0DA.WAV" />
        <Wave file="909/RIDED2.WAV" />
        <Wave file="909/ST7T7S7.WAV" />
        <Wave file="909/HANDCLP1.WAV" />
        <Wave file="909/RIM63.WAV" />
        <Wave file="909/LT0D0.WAV" />
        <Wave file="909/HHCDA.WAV" />
        <Wave file="909/HHODA.WAV" />
    </Waves>
</Repulse>
}}}

And introducing a *file* value that corresponds to the location of your wave file.<br>
The machine will look for wave files relative to its directory, you can enter absolute paths too.<br>
Check the [EditingPatches Editing Patches] page for more information on how to edit the xml file.

=Tips and tricks=

There is an extensive list of ideas you can test in the [TipsAndTricks Tips And Tricks] page.<br>
Be sure to check this page to get some interesting ideas on how to use the machine.

=Utilised libraries=
This software depends on a number of great libraries:

 * [http://www.alsa-project.org Alsa] Audio and MIDI functionality.
 * [http://jackaudio.org Jack] Real-time, low latency audio and MIDI.
 * [http://www.mega-nerd.com/libsndfile SndFile] An unified sound file access library.
 * [http://www.mega-nerd.com/SRC Secret Rabbit Code] A samplerate conversion library (libsamplerate),
 * [http://www.surina.net/soundtouch SoundTouch] SOLA time stretching library.
 * [http://www.grinninglizard.com/tinyxml TinyXML] A small XML library.
 * [http://www.math.sci.hiroshima-u.ac.jp/~m-mat/MT/SFMT SFMT] A fast [http://en.wikipedia.org/wiki/Mersenne_twister Merssene Twister] implementation.

=Team=

This is the great team the makes repulse possible:

 * Jaume Aguilera: adviser and tester.
 * Juan Carlos Rodrigo: lead coder and tester.